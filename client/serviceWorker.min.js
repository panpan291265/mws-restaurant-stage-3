const cachePrefix="resto-revs",cacheVersion="v0001",cacheName="resto-revs-v0001",apiServer="http://localhost:1337";self.addEventListener("install",e=>{e.waitUntil(caches.open(cacheName).then(function(e){let s=["index.html","restaurant.html","restaurant_review.html","unavailable.html","img/restaurant-128.png","img/restaurant-256.png","img/restaurant-512.png","img/restaurant.png","css/styles.common.css","css/styles.common.min.css","css/styles.index.css","css/styles.index.min.css","css/styles.restaurant.css","css/styles.restaurant.min.css","css/styles.restaurant_review.css","css/styles.restaurant_review.min.css","js/idb.js","js/idb.min.js","js/urlhelper.js","js/urlhelper.min.js","js/dbhelper.js","js/dbhelper.min.js","js/main.js","js/main.min.js","js/restaurant_info.js","js/restaurant_info.min.js","js/restaurant_review.js","js/restaurant_review.min.js"];const t=["","-200","-300","-400","-500","-600"];return["1","2","3","4","5","6","7","8","9","10","image-not-found"].forEach(e=>{t.forEach(t=>s.push(`img/${e}${t}.jpg`))}),e.addAll(s).then(()=>self.skipWaiting())}).catch(e=>console.error(e)))}),self.addEventListener("activate",e=>{}),self.addEventListener("fetch",e=>{let s=e.request.url;if(s.startsWith(apiServer))return fetch(e.request);const t=new Promise((t,a)=>{caches.open(cacheName).then(r=>{r.match(s).then(n=>{if(n)return t(n);fetch(e.request).then(e=>(r.put(s,e.clone()),t(e))).catch(s=>{if(!e.request.url.includes("restaurant.html?id=")&&!e.request.url.includes("restaurant_review.html?id="))return a(s);r.match("unavailable.html").then(e=>t(e))})})})});e.respondWith(t)}),self.addEventListener("sync",e=>{e.tag.startsWith("sync-")&&self.clients.matchAll().then(s=>{s.forEach(s=>s.postMessage({id:"synchronize-data",tag:e.tag}))})}),self.addEventListener("message",e=>{"cacheRestaurantSites"===e.data.action&&e.data.restaurants&&e.data.restaurants.length>0&&caches.open(cacheName).then(function(s){let t=[];e.data.restaurants.forEach(e=>{t.push(`restaurant.html?id=${e.id}`),t.push(`restaurant_review.html?id=${e.id}`)}),s.addAll(t)})});